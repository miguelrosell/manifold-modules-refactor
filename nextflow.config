/*
 *========================================================================================
 * nf-core/manifold Nextflow config file
 *========================================================================================
 * Default config options for all compute environments
 */

// Global default parameters
params {
    // Input options
    input                      = null
    outdir                     = 'results'
    
    // Geometry Module defaults
    skip_geometry              = false
    manifold_method            = 'phate'
    n_neighbors                = 15
    
    // Topology defaults
    calc_topology              = true 
    
    // Causality defaults
    calc_causality             = true
    n_top_genes                = 100
    
    // AI defaults
    use_foundation_model       = false
}

// Enable Docker by default
docker.enabled = true

// Process resource configuration
process {
    // Default resources for all processes
    cpus   = 2
    memory = '6 GB'
    time   = '4h'

    // --- AQUÍ ESTÁ EL CAMBIO CLAVE PARA VER TUS ARCHIVOS ---

    withName: GEOMETRY_MANIFOLD {
        cpus   = 4
        memory = '8 GB'
        // Publicar resultados de Geometría
        publishDir = [
            path: { "${params.outdir}/geometry" },
            mode: 'copy',
            overwrite: true
        ]
    }

    withName: TOPOLOGY_TDA {
        // Publicar resultados de Topología
        publishDir = [
            path: { "${params.outdir}/topology" },
            mode: 'copy',
            overwrite: true
        ]
    }

    withName: CAUSALITY_INFER {
        cpus   = 2
        memory = '4 GB'
        // Publicar resultados de Causalidad
        publishDir = [
            path: { "${params.outdir}/causality" },
            mode: 'copy',
            overwrite: true
        ]
    }
}

// Profiles allow users to switch between Docker, Singularity, or Conda
profiles {
    docker {
        docker.enabled         = true
        docker.runOptions      = '-u $(id -u):$(id -g)' 
        singularity.enabled    = false
    }
    singularity {
        singularity.enabled    = true
        singularity.autoMounts = true
        docker.enabled         = false
    }
    conda {
        conda.enabled          = true
        docker.enabled         = false
        singularity.enabled    = false
    }
}

// Manifest detailing the pipeline metadata
manifest {
    name            = 'nf-core/manifold'
    author          = 'Your Name'
    homePage        = 'https://github.com/nf-core/manifold'
    description     = 'Topological and Causal analysis pipeline for scRNA-seq'
    mainScript      = 'main.nf'
    nextflowVersion = '!>=23.04.0'
    version         = '1.0dev'
}
